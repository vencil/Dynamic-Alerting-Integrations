# CI/CD environment configuration for threshold-exporter

image:
  repository: ghcr.io/vencil/threshold-exporter
  tag: v0.8.0
  pullPolicy: IfNotPresent

service:
  type: ClusterIP
  port: 8080
  annotations:
    prometheus.io/scrape: "true"
    prometheus.io/port: "8080"
    prometheus.io/path: "/metrics"

exporter:
  listenAddr: ":8080"
  reloadInterval: "60s"    # Less frequent in CI

# CI threshold config â€” thresholds would be managed via GitOps
thresholdConfig:
  defaults:
    mysql_connections: 80
    mysql_cpu: 80
    container_cpu: 80
    container_memory: 85
  state_filters:
    container_crashloop:
      reasons: ["CrashLoopBackOff"]
      severity: "critical"
    container_imagepull:
      reasons: ["ImagePullBackOff", "InvalidImageName"]
      severity: "warning"
  tenants: {}    # Populated per-environment via values override

resources:
  requests:
    cpu: 100m
    memory: 128Mi
  limits:
    cpu: 500m
    memory: 256Mi

replicaCount: 1

livenessProbe:
  httpGet:
    path: /health
    port: http
  initialDelaySeconds: 10
  periodSeconds: 10

readinessProbe:
  httpGet:
    path: /ready
    port: http
  initialDelaySeconds: 5
  periodSeconds: 5
